---
# IMPORTANT: Change settings here, but DO NOT change the spacing.
# Remove comments and add values where applicable.
# The descriptions below should be self-explanatory

title: "What Caused The Early Millenium Slowdown? Evidenece Based on Vector Autoregressions"
subtitle: "A replication of Gert Peersman (2005) paper"

documentclass: "elsarticle"

# --------- Thesis title (Optional - set to FALSE by default).
# You can move the details below around as you please.
Thesis_FP: FALSE
# Entry1: "An unbelievable study with a title spanning multiple lines."
# Entry2: "\\textbf{Nico Katzke}" # textbf for bold
# Entry3: "A thesis submitted toward the degree of Doctor of Philosophy"
# Uni_Logo: Tex/Logo.png # Place a logo in the indicated location (from your root, e.g. defaults to ~/Tex/Logo.png) and uncomment this line. Leave uncommented for no image
# Logo_width: 0.3 # If using a logo - use this to set width (size) of image
# Entry4: "Under the supervision of: \\vfill Prof. Joe Smith and Dr. Frank Smith"
# Entry5: "Stellenbosch University"
# Entry6: April 2020
# Entry7:
# Entry8:

# --------- Front Page
# Comment: ----- Follow this pattern for up to 5 authors
AddTitle: TRUE # Use FALSE when submitting to peer reviewed platform. This will remove author names.
Author1: "Jessica Van der Berg"  # First Author - note the thanks message displayed as an italic footnote of first page.
Ref1: "20190565" # First Author's Affiliation
Email1: "20190565\\@sun.ac.za" # First Author's Email address


keywords: "Multivariate GARCH \\sep Kalman Filter \\sep Copula" # Use \\sep to separate
JELCodes: "L250 \\sep L100"

# ----- Manage headers and footers:
#BottomLFooter: $Title$
#BottomCFooter:
#TopLHeader: \leftmark # Adds section name at topleft. Remove comment to add it.
BottomRFooter: "\\footnotesize Page \\thepage" # Add a '#' before this line to remove footer.
addtoprule: TRUE
addfootrule: TRUE               # Use if footers added. Add '#' to remove line.

# --------- page margins:
margin: 2.3 # Sides
bottom: 2 # bottom
top: 2.5 # Top
HardSet_layout: TRUE # Hard-set the spacing of words in your document. This will stop LaTeX squashing text to fit on pages, e.g.
# This is done by hard-setting the spacing dimensions. Set to FALSE if you want LaTeX to optimize this for your paper.

# --------- Line numbers
linenumbers: FALSE # Used when submitting to journal

# ---------- References settings:
# You can download cls format here: https://www.zotero.org/ - simply search for your institution. You can also edit and save cls formats here: https://editor.citationstyles.org/about/
# Hit download, store it in Tex/ folder, and change reference below - easy.
bibliography: Tex/ref.bib       # Do not edit: Keep this naming convention and location.
csl: Tex/harvard-stellenbosch-university.csl # referencing format used.
# By default, the bibliography only displays the cited references. If you want to change this, you can comment out one of the following:
#nocite: '@*' # Add all items in bibliography, whether cited or not
# nocite: |  # add specific references that aren't cited
#  @grinold2000
#  @Someoneelse2010

# ---------- General:
RemovePreprintSubmittedTo: TRUE  # Removes the 'preprint submitted to...' at bottom of titlepage
Journal: "Journal of Finance"   # Journal that the paper will be submitting to, if RemovePreprintSubmittedTo is set to TRUE.
toc: FALSE                       # Add a table of contents
numbersections: TRUE             # Should sections (and thus figures and tables) be numbered?
fontsize: 11pt                  # Set fontsize
linestretch: 1.2                # Set distance between lines.
link-citations: TRUE            # This creates dynamic links to the papers in reference list.

### Adding additional latex packages:
# header-includes:
#    - \usepackage{colortbl} # Add additional packages here.

output:
  pdf_document:
    keep_tex: TRUE
    template: Tex/TexDefault.txt
    fig_width: 3.5 # Adjust default figure sizes. This can also be done in the chunks of the text.
    fig_height: 3.5
abstract: |
  Abstract to be written here. The abstract should not be too long and should provide the reader with a good understanding what you are writing about. Academic papers are not like novels where you keep the reader in suspense. To be effective in getting others to read your paper, be as open and concise about your findings here as possible. Ideally, upon reading your abstract, the reader should feel he / she must read your paper in entirety.
---

<!-- First: Set your default preferences for chunk options: -->

<!-- If you want a chunk's code to be printed, set echo = TRUE. message = FALSE stops R printing ugly package loading details in your final paper too. I also suggest setting warning = FALSE and checking for warnings in R, else you might find ugly warnings in your paper. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
# Note: Include = FALSE implies the code is executed, but not printed in your pdf.
# warning and message = FALSE implies ugly messages and warnings are removed from your pdf.
# These should be picked up when you execute the command chunks (code sections below) in your rmd, not printed in your paper!

# Lets load in example data, and see how this can be stored and later called from your 'data' folder.
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)


slowdown_dataset <- read.table("~/GitHub/Time-Series/replication/data/slowdown_dataset.txt", quote="\"", comment.char="")

slowdown_dataset <- slowdown_dataset %>% rename(Date = V1, OIL = V2, YEMU = V3, CPEMU = V4, SEMU = V5, YUS= V6, CPUS = V7, SUS = V8) 
slowdown_dataset <- slowdown_dataset[-c(131), ] 
slowdown_dataset <-slowdown_dataset[-c(1:39),]


```


<!-- ############################## -->
<!-- # Start Writing here: -->
<!-- ############################## -->

# Introduction 

In this research assignment, I replicate a research assignment by Gert Peersman (2005), a German economist, titled "What caused the early millennium slowdown? Evidence based on vector autoregressions". In this paper, Peersman (2005) uses a simple four-variable VAR (vector autogressive model) and an identification based scheme based on sign restrictions to examine the effects of a supply, demand, monetary policy and oil price shocks. Peersman (2005) uses data from the United States and Euro area. However, this assignment will only focus on analyzing shocks for the USA. Peersman (2005) concludes that the millennial slowdown is not the result of one particular shock, but a combination of them. The goal of this assignment is to replicate the results of Peersman (2005) as well as preform additional robustness test to ensure the validity of Peermans (2005) results.

- summarize what robustiness checks and analysis you did(including the ones that you replicate)

This paper is structured as follows: The first section will give an overview of the paper with respects to the economics, methodology and data that Peersman (2005) used. The second section will replicate the results for the US. The third section will perform robustness checks and the forth section will conclude.

# Overview of the paper

This section gives a brief overview of the economics of Peersman (2005) and a critical evaluation of the statistical approach that Peersman (2005) choose to analyze possible causes for the economic slowdown of the US. 

## Literature Review 

The 1990s was the start of an economic boom for the United States as they experienced the unusual combination of rapid output growth and extremely low and stable inflation. From 1994 to 2002 the United States real GDP grew by an average annual rate of almost 4 percent while annual inflation was less than 2 percent.  However, by the end of 2001, the US began to experience negative growth (Peersman, 2005).  Since 2001, the US economy has not experienced close to the same economic growth. It is therefore important to understand what caused the slowdown. 

The economic expansion that the US experienced made headlines as it was the longest expansion in economic history.  Many explanations have been offered as to why the US experienced such rapid growth, but overall, it is attributed to numerous factors. Productivity growth increased tremendously which created a favorable investment environment. The private investment opportunities contributed to the advancements in technologies and inspired innovation (Weller, 2002). Furthermore, the Federal Open Market Committee (FOMC) created an environment for the Federal Reserve to keep inflation rates low and stable (Taylor, 1998).  

Another possible reason is that the US economy mostly experienced positive shocks during the late 1990s. The Fed has the responsibility to responds to shocks to the economy to ensure that output, employment, and inflation remain stable.  The Fed can easily respond to a demand shock as it pushed output, employment, and inflation in the same direction. Therefore, the Fed will lower interest rate which will increase money supply to combat the effects of a demand shock. However, supply shock, such as an increase in oil prices, are more complicated to respond. With the threat of a recession, the Fed will need to decide whether to prioritize inflation stability or employment stability. Which attributed the economic boom that the US experienced, is the fact that large supply shocks were uncommon during the 1990s.

After 10 years of economic growth, the US economy entered a recession. The 2001/2002 was relatively short lived. Kliesen (2003) argues that the recession was caused by shocks to investment by businesses and households and by a decline in real net exports.  However, Kleisen (2003) does recognize that it can be extremely difficult to challenging to discover the root cause of a recession. Understanding fluctuation in the growth of an economy has been research by many economists but it is still relatively poorly understood. Therefore, Peersman (2005) adds value to research by examining four shocks (oil, demand, supply, and monetary policy) to analyze the origin of the slowdown.

Peersman (2005) concludes that the slowdown of economic growth was caused by a combination of several shocks. This conclusion is non-surprising and therefore Peersman (2005) main contribution is the impressive mathematical and statistical analysis that he performed. 

## Data and Methodology 
This paper used quarterly data from 1980 to 2002 on the US consumer expenditure index (CPUS), real GDP (YUS), short term nominal interest rate (SUS) as well as data on the oil price (OIL). Changes in CPUS record the rate of consumer inflation while changes in YUS record output growth. The data is then manipulated to display the first difference of the log of OIL, YUS and CPUS and these variables are assumed to be I(1) variables. The SUS variable is taken as an I(0) variable (Ouliaris, Pagan & Restrepo, 2018). The data is presented in figure 2.1 below.


```{r Figure1, warning =  FALSE, fig.align = 'center', fig.cap = "Data\\label{Figure1}", fig.height = 5, fig.width = 6, dev = 'png'}
library(dplyr)
# Data manipulation. 

y1 = 100*log(as.numeric(slowdown_dataset$YUS))
p1= 100*log(as.numeric(slowdown_dataset$CPUS))
Wp = 100*log(as.numeric(slowdown_dataset$OIL))
s1 <- as.numeric(slowdown_dataset$SUS[-1])

dy1 <- diff(y1)
dp1 <- diff(p1)
dWp <- diff(Wp)

ly <- dy1 - mean(dy1, na.rm=T)
lp <- dp1 - mean(dp1,na.rm=T)
lw <- dWp - mean(dWp, na.rm=T)
ls <- s1 - mean(s1, na.rm=T)

YUS <- ts(ly , start=c(1980,1), frequency = 4)
CPUS <- ts(lp , start=c(1980,1), frequency = 4)
OIL <- ts(lw , start=c(1980,1), frequency = 4)
SUS <- ts(ls , start=c(1980,1), frequency = 4)
vardat0 <- cbind(OIL,YUS, CPUS, SUS)
vardat0 <- vardat0[-c(91),]


plot.ts(vardat0, main="Representation of Data")

```

Peersman (2005) estimates a four-variable constant-coefficient  vector autpregression (VAR) model, with three lags and identifies four shocks. The variables included in the analysis is the first difference of oil prices, output growth measured by the real GDP index, consumer inflation measured by consumer price index and short-term nominal interest rates. The four shocks that are analyzed in this paper; two supply shocks, one demand shock and one monetary policy shock. The two supply shocks represents a shock to the oil price and a shock to output growth. The demand shock is associated with a shock to consumer inflation (CPUS), while the monetary policy shock is associated with a shock to the short term nominal interest rate. Taking the four varaibles and shocks into account, the equation can be presented as follows: 

\[\begin{bmatrix} \Delta oil_t \\ \Delta y_t \\ \Delta p_t \\ s_t \end{bmatrix} = \Biggl[ I - \sum_{i=1}^{n} A_i \Biggl]^{-1} \begin{bmatrix} b_{11}& b_{12}& b_{13} & b_{14} \\
b_{21}& b_{22}& b_{23} & b_{24} \\
b_{31}& b_{32}& b_{33} & b_{34} \\
b_{41}& b_{42}& b_{43} & b_{44} \end{bmatrix} \begin{bmatrix} \epsilon_t^{oil} \\ \epsilon_t^{s} \\ \epsilon_t^{d} \\ \epsilon_t^{m} \end{bmatrix}\]

Where \(\Delta oil_t\), \(\Delta y_t\) and \(\Delta p_t\) represent the first difference of the price of oil, output growth and the consumer prices respectively. \( s_t\) represents the short term nominal interest rate. The oil price, demand, supply and monetary shock in represented by \(\epsilon_t^{oil}\), \(\epsilon_t^{d}\),  \(\epsilon_t^{s}\) and \(\epsilon_t^{m}\) respectively. 

Peersman (2005) assumes that the variables follow a covariance stationary process. He uses the Dickey fuller test to reject the null hypothesis of the existence of a unit root at a 10 percent level for OIL, YUS and CPUS, however, the null hypothesis for interest rates cannot be rejected. Peersman (2005) makes the assumption that interest rates are stationary since the nominal rate cannot have a unit root if both the real rate and inflation are stationary. This assumption will be intensely analyzed in section xx during which I will preform numerous robustness checks. 

The paper makes use of a traditional identification strategy using a combination of short-run and long-run restrictions. For the purpose of this assignment, the short-run and long-run restrictions will be discussed and modeled separately. Peersman (2005) assumes that there is a contemporaneous impact of an oil shock on all variables in the VAR, but no immediate impact of other shocks on oil prices. This assumption is consistent with previous literature. Further Peersman (2005) adds the restrictions that a monetary policy shock has no contemporaneous effect on output, since monetary policy shocks have a temporary effect on output. To model these contemporaneous effects \(b_{12} = b_{13} = b_{14} = b_{24} = 0\). However, to accurately model the contempoarous effects, the VAR needs \([k^2-k]/2\) restrictions, where k represents the number of variables. This implies that a further two contemporaneous effects are needed to model the short-run and long run restrictions further. I will argue two more contemporaneous effects that are consistent with past literature in the next section. Taking into account only the contemporanous effects that Peersman (2005) specifically specified in his paper, your matrix will change to:

\[\ \begin{bmatrix} b_{11}& 0 & 0 & 0 \\
b_{21}& b_{22}& b_{23} & 0 \\
b_{31}& b_{32}& b_{33} & b_{34} \\
b_{41}& b_{42}& b_{43} & b_{44} \end{bmatrix} \]

Peersman (2005) follows Blanchard and Quah (1989), Gali (1992) and Gerlach and Smeth (1995) to add long-run restrictions to the model. He assumes that demand shock has a permanent zero long-run effect of output growth YUS. Furthermore, Peersman (2005) assumes that monetary shocks has a zero long-run impact on output growth but a non-zero effect of OIL and CPUS. Therefore, your long-run restriction matrix will be represented as follow; 

\[\ \begin{bmatrix} *& *& *& * \\
*& *& 0 & 0 \\
*& *& *& * \\
*& *& * & * \end{bmatrix} \]

where the zero's represent restrictions. In the next section I present and evaluate impulse response functions that are correlated with the VAR specified by Peersman (2005). 

# Evaluating the Economic Slowdown

In this section, I use Peersman (2005) data on the US to plot impulse response function taking into account the short run and long run restrictions specified.

## Short run restrictions 

In Peersman (2005) he applies four short run restrictions to his VAR. Since we have 4 variables in our VAR, 6 restrictions are required to examine the VAR correctly. Therefore, I add two short run restrictions in additional to Peersmans restrictions. The first restriction I add is that a shock to consumer inflation, a demand shock, has contemporaneous affect on output growth (YUS). Peersman (2005) specifies that a monetary policy shock has no contemporaneous effect on output, and since monetary policy shocks are a combination of money demand and exchange rate shocks, this restriction is valid.

The second restriction I add is that a monetary policy shock has no contemporaneous effect on consumer inflation. This restriction is supported by McMillin (2001) who studied the the effect of monetary policy shocks on macroeconomic variables. McMillin (2001) argued that monetary policy shocks only affect consumer inflation with a lag, therefore there will be no affect in the short-run. Therefore the matrix for the contemporaneous coefficient will have the following formation;

\[\ \begin{bmatrix} b_{11}& 0 & 0 & 0 \\
b_{21}& b_{22}& 0 & 0 \\
b_{31}& b_{32}& b_{33} & 0 \\
b_{41}& b_{42}& b_{43} & b_{44} \end{bmatrix} \]

This matrix expresses that only shocks to OIL can shift OIL contemporaneously. Only shock to OIL and YUS can shift output growth (YUS) contemporaneously. Only shocks to OIL, YUS and CPUS and shift consumer inflation contemporaneously and all shock can affect the interest rate contemporaneously. I will now examine how each variable responds to a the four different shocks, where each structural shock is of size one. First, I will examine the effects of an oil shock. 
```{r Figure2, warning =  FALSE, fig.align = 'center', fig.cap = "Response of Oil Price\\label{Figure2}", fig.height = 5, fig.width = 6, dev = 'png'}

library(vars)
library(cowplot)
library(gridExtra)
# Using data calculated below. 

# Prove that one lag is optimal. 
# We want to get a reduced-form VAR to get an appropriate object that is manipulated into the structural form model 

var1 <- VAR(vardat0, p=3, type="both")


# apply long run restrictions 
model1 <- BQ(var1)


#contemporanous effects
a.mat <- diag(4)
diag(a.mat) <- 1
a.mat[1,2] <- 0
a.mat[1,3] <- 0
a.mat[1,4] <- 0
a.mat[2,1] <- NA
a.mat[3,1] <- NA
a.mat[4,1] <- NA
a.mat[2,3] <- 0
a.mat[2,4] <- 0
a.mat[3,2] <- NA
a.mat[3,4] <- 0
a.mat[4,2] <- NA
a.mat[4,3] <- NA


b.mat <- diag(4)
diag(b.mat)<- NA

svar.one <- SVAR(var1, Amat=a.mat, Bmat=b.mat, hessian=TRUE, max.iter=1000)

RESPONSE = "OIL"
IMPULSE=c("OIL", "YUS", "CPUS", "SUS")

fits=lapply(IMPULSE, function(i){
    irf(svar.one,response=RESPONSE,impulse=i,n.ahead=40,ortho=TRUE,boot=TRUE, ci=0.84)
})
names(fits) = IMPULSE

plotdf = lapply(names(fits),function(i){
data.frame(
  index = 1:nrow(fits[[i]]$irf[[1]]),
  value=fits[[i]]$irf[[1]][,1],
  Lower=fits[[i]]$Lower[[1]][,1],
  Upper=fits[[i]]$Upper[[1]][,1],
  Impulse = i)
})
plotdf=do.call(rbind,plotdf)

a <-ggplot(plotdf,aes(x=index,y=value)) + 
geom_line() +facet_wrap(~Impulse, scales="free_y") + 
labs(xlab="",ylab="",title="Oil's Response", subtitle ="Response to all shocks taking contemporanous restrictions into account", caption="Note:\nOwn calculations" ) +
geom_ribbon(aes(ymin=Lower,ymax=Upper),fill=NA,col="salmon",linetype="dashed") + 
geom_hline(yintercept=0,col="salmon") + theme_bw()

a

```
Figure 3.1 shows how oil responds to the four shocks discussed in the previous section. We can derive that no shock has a permanent effect on the price of oil, with a demand shock (CPUS) and supply shock (YUS) increasing the price of oil more than the size of the structural shock in the short run, while a monetary policy shock (SUS) decreases the price of oil. Therefore, the response of oil to the four shocks is insignificant in the long run. A positive demand and supply shock increase the price of oil, which is the same results Peersman (2005) arrived at in his analysis. Figure 3.2 represents output growth response to the four different shocks. 
```{r Figure3, warning =  FALSE, fig.align = 'center', fig.cap = "Response of Output growth\\label{Figure3}", fig.height = 5, fig.width = 6, dev = 'png'}
RESPONSE = "YUS"
IMPULSE=c("OIL", "YUS", "CPUS", "SUS")

fits=lapply(IMPULSE, function(i){
    irf(svar.one,response=RESPONSE,impulse=i,n.ahead=40,ortho=TRUE,boot=TRUE, ci=0.84)
})
names(fits) = IMPULSE

plotdf = lapply(names(fits),function(i){
data.frame(
  index = 1:nrow(fits[[i]]$irf[[1]]),
  value=fits[[i]]$irf[[1]][,1],
  Lower=fits[[i]]$Lower[[1]][,1],
  Upper=fits[[i]]$Upper[[1]][,1],
  Impulse = i)
})
plotdf=do.call(rbind,plotdf)

b <-ggplot(plotdf,aes(x=index,y=value)) + 
geom_line() +facet_wrap(~Impulse, scales="free_y") + 
labs(xlab="",ylab="",title="Output Growth Response", subtitle ="Response to all shocks taking contemporanous restrictions into account", caption="Note:\nOwn calculations" ) +
geom_ribbon(aes(ymin=Lower,ymax=Upper),fill=NA,col="salmon",linetype="dashed") + 
geom_hline(yintercept=0,col="salmon") + theme_bw()

b
```
Output growth has a strong negative response to a demand, oil and monetary policy shock, where the pass-through of an demand shock is much slower then the other shocks. 
A monetary policy shock first has a slight positive effect on output, before it starts diminishing, which is consistent with Khan (2008) analysis. The negative impact that an increase in  oil price has on output growth is also consistent with literature. Jiménez-Rodríguez and Sánchez (2005) found a negative relationship on an increase in oil price on economic activity for oil importing countries. I will now analyse the response of consumer inflation to the four different shocks are displayed in figure 3.4 below

```{r Figure4, warning =  FALSE, fig.align = 'center', fig.cap = "Consumer Expenditure Index\\label{Figure4}", fig.height = 5, fig.width = 6, dev = 'png'}
RESPONSE = "CPUS"
IMPULSE=c("OIL", "YUS", "CPUS", "SUS")

fits=lapply(IMPULSE, function(i){
    irf(svar.one,response=RESPONSE,impulse=i,n.ahead=40,ortho=TRUE,boot=TRUE, ci=0.84)
})
names(fits) = IMPULSE

plotdf = lapply(names(fits),function(i){
data.frame(
  index = 1:nrow(fits[[i]]$irf[[1]]),
  value=fits[[i]]$irf[[1]][,1],
  Lower=fits[[i]]$Lower[[1]][,1],
  Upper=fits[[i]]$Upper[[1]][,1],
  Impulse = i)
})
plotdf=do.call(rbind,plotdf)

c <-ggplot(plotdf,aes(x=index,y=value)) + 
geom_line() +facet_wrap(~Impulse, scales="free_y") + 
labs(xlab="",ylab="",title="Consumer Expenditure Index Response", subtitle ="Taking contemporanous restrictions into account", caption="Note:\nOwn calculations" ) +
geom_ribbon(aes(ymin=Lower,ymax=Upper),fill=NA,col="salmon",linetype="dashed") + 
geom_hline(yintercept=0,col="salmon") + theme_bw()

c
```
AS seen in Figure 3.4, consumer expenditure index which represents consumer inflation, responds positively to all shocks. The oil price shock has a small and insignificant effect on inflation as the increase in inflation is short-lived. During the 1970's, oil prices increased dramatically which encouraged the adoption of energy-saving technology which lead to the importance of oi decreasing (Bachmeier & Cha, 2011). The positive effect that monetary policy has on inflation is unsurprising as inflation immediately increases in response to an increase in interest rates and then slowly decreases. Therefore, the small effect of an oil shock and monetary policy shock on inflation is consistent with literature. Lastly, the response of interest rates to all four shocks are analysed in figure 3.5 below.

```{r Figure5, warning =  FALSE, fig.align = 'center', fig.cap = "Interest Rate Response\\label{Figure5}", fig.height = 5, fig.width = 6, dev = 'png'}
RESPONSE = "SUS"
IMPULSE=c("OIL", "YUS", "CPUS", "SUS")

fits=lapply(IMPULSE, function(i){
    irf(svar.one,response=RESPONSE,impulse=i,n.ahead=40,ortho=TRUE,boot=TRUE, ci=0.84)
})
names(fits) = IMPULSE

plotdf = lapply(names(fits),function(i){
data.frame(
  index = 1:nrow(fits[[i]]$irf[[1]]),
  value=fits[[i]]$irf[[1]][,1],
  Lower=fits[[i]]$Lower[[1]][,1],
  Upper=fits[[i]]$Upper[[1]][,1],
  Impulse = i)
})
plotdf=do.call(rbind,plotdf)

d <-ggplot(plotdf,aes(x=index,y=value)) + 
geom_line() +facet_wrap(~Impulse, scales="free_y") + 
labs(xlab="",ylab="",title="Interest Rate Response", subtitle ="Taking contemporanous restrictions into account", caption="Note:\nOwn calculations" ) +
geom_ribbon(aes(ymin=Lower,ymax=Upper),fill=NA,col="salmon",linetype="dashed") + 
geom_hline(yintercept=0,col="salmon") + theme_bw()

d
```
Figure 3.5 replicate Peersman (2005) results as Peersman adds no contemporaneous or long-run restrictions on short-term nominal interest rates. An oil shock increases interest rates temporarily to counterbalance the inflationary pressure. The demand and supply shock has a positive effect on short-term nominal interest rates with the effect slowly diminishing over time. These results are consistent with literature. In the next section, I will analyze the effects of the long run restrictions. 

## Long run restrictions

To implemented the long-run restrictions specified by Peersman (2005), I implement an identification scheme proposed by Blanchard-Quah (1989). In the original model, the assumption is made that demand shock has no effect on the long run levels of output. Peersman (2005) makes the same assumption is his paper. In order to make the implementation of Blachard-Quah successful, I need to make an additional four long run restrictions. I assume that all shocks, except an oil price shock, have no long run impact on the price of oil. Furthermore, I assume that a monetary policy shock has no long run impact on consumer inflation. Therefore, my long run restriction matrix will take the following


\[\ \begin{bmatrix} *& 0& 0 & 0\\
*& *& 0 & 0 \\
*& *& *& 0 \\
*& *& * & * \end{bmatrix} \]

```{r}
var1 <- VAR(vardat0, p=3, type="both")


# apply long run restrictions 
model1 <- BQ(var1)
summary(model1)

RESPONSE = "CPUS"
IMPULSE=c("OIL", "YUS", "CPUS", "SUS")

fits=lapply(IMPULSE, function(i){
    irf(model1,response=RESPONSE,impulse=i,n.ahead=40,ortho=TRUE,boot=TRUE, ci=0.84)
})
names(fits) = IMPULSE

plotdf = lapply(names(fits),function(i){
data.frame(
  index = 1:nrow(fits[[i]]$irf[[1]]),
  value=fits[[i]]$irf[[1]][,1],
  Lower=fits[[i]]$Lower[[1]][,1],
  Upper=fits[[i]]$Upper[[1]][,1],
  Impulse = i)
})
plotdf=do.call(rbind,plotdf)

a <-ggplot(plotdf,aes(x=index,y=value)) + 
geom_line() +facet_wrap(~Impulse, scales="free_y") + 
labs(xlab="",ylab="",title="Oil's Response", subtitle ="Response to all shocks taking long run restrictions into account", caption="Note:\nOwn calculations" ) +
geom_ribbon(aes(ymin=Lower,ymax=Upper),fill=NA,col="salmon",linetype="dashed") + 
geom_hline(yintercept=0,col="salmon") + theme_bw()

a


```




# Structural VAR 

Argue that authors do no make use of a simple VAR but rather a structural VAR. 

First VAR analysis that Peersman does is based on conventional zero contemporaneous and long run restrictions. Peersman assumes that there is a contemporaneous impact of an oil shock on all other variables in the system, but no immediate impact of the other shocks on oil 


## ACTUAL PROJECT DTAA

# JB TEST 
```{r}
# NOt to sure what I am suppose to do with these results or how to interpret them. 

if(!require(tseries)){install.packages('tseries')}
library(tseries)

jarque.bera.test(as.numeric(vardat0))
```



# Test wether variables are stationary \label{stationary}
 
Variables that are included in the dataset (same order): oil, output growth, consumer inflation and short-term nominal interest rate for EU and US. 

Gideon suggested I only do the replication for the US, since this will be a lot of work. 


In order to test whether a variable is stationary, you can use a unit root test such as the Dickey-Fuller (DF) test

Null hypothesis: There is a unit root 
Alternative hypothesis: Time series is stationary 

If p-values is less than 0.05, it means we can reject the null hypothesis. 

```{r}

library(tseries)
library(ggplot2)
library(dplyr)

detach("package:dplyr", character.only = TRUE)
library("dplyr", character.only = TRUE)

 x <- as.data.frame(vardat0)
adf.test(x$OIL)
adf.test(x$YUS)
adf.test(x$SUS)
adf.test(x$CPUS)

pp.test(x$OIL)
pp.test(x$YUS)
pp.test(x$SUS)
pp.test(x$CPUS)
```


#Optimal lag length

I now determine the optimal lag length for an unrestricted VAR with a maximum lag length of 10.

According to the AIC and the FPE, the optimal lag length is 4. However, the SC and HQ criterion indicates an optimal lag length of 1. The data estimates a VAR including a constant and a trend as deterministic regressor. 

I will use a VAR with lag length eual to one as specified by the paper.

```{r}
library(vars)
detach("package:dplyr", character.only = TRUE)
library("dplyr", character.only = TRUE)

#putting my data in a time series object
lag <- VARselect(vardat0, type="both") 
lag
```



# Diagnostic tests and Test statistics

The results for diagnostic test for VAR(1), VAR(2) and VAR(3) are provided in the table below.

Here you look and interpret all the test to determine whether VAR(1) is too restrictive. ARGUE this as part of your robustness test for the paper. 

```{r}
ser11 <- serial.test(VAR(vardat0, p=1, type ="const"), lags.pt = 16, type ="PT.asymptotic")
ser11$serial

norm1 <- normality.test(VAR(vardat0, p=1, type ="const"))
norm1$jb.mul

arch1 <- arch.test(VAR(vardat0, p=1, type ="const"), lags.multi = 5)
arch1$arch.mul

```

# Conclusion


\newpage

# References {-}
Blanchard, O.J., 1989. A traditional interpretation of macroeconomic fluctuations. The American Economic Review, pp.1146-1164.

Jiménez-Rodríguez*, R. and Sánchez, M., 2005. Oil price shocks and real GDP growth: empirical evidence for some OECD countries. Applied economics, 37(2), pp.201-228.

Khan, M. U. H. (2008). Short run effects of an unanticipated change in monetary policy:
Interpreting macroeconomic dynamics in Pakistan. State Bank of Pakistan Working
Paper, 22.

Kliesen, K.L., 2003. The 2001 recession: How was it different and what developments may have caused it?.Review-Federal Reserve Bank of Saint Louis, 85(5), pp.23-38.

McMillin, W.D., 2001. The Effects of monetary policy shocks: comparing contemporaneous versus long-run identifying restrictions. Southern Economic Journal, pp.618-636.

Ouliaris, S., Pagan, A. and Restrepo, J., 2016. Quantitative macroeconomic modeling with structural vector autoregressions–an EViews implementation. IHS Global, 13.

Peersman, G., 2005. What caused the early millennium slowdown? Evidence based on vector autoregressions. Journal of Applied Econometrics, 20(2), pp.185-207.

Taylor, J.B., 1998. Monetary policy and the long boom. Federal Reserve Bank of St. Louis Review, 80(6), p.3.

Weller, C., 2002. Lessons from the 1990s: Long‐term growth prospects for the US. New Economy, 9(1), pp.57-61.





# Appendix {-}

## Appendix A {-}

Some appendix information here

## Appendix B {-}

